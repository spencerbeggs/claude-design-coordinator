# Export Formats Reference

Detailed specifications for each export format supported by design-export.

## Overview

The design-export skill supports three output formats:

1. **Markdown** - Plain text with markdown formatting
2. **HTML** - Styled web pages with CSS
3. **PDF** - Print-ready documents via LaTeX

Each format has specific processing steps, requirements, and best use cases.

## Format 1: Markdown

### Markdown Best Use Cases

- Version control and git tracking
- Plain text archival
- Further processing or transformation
- Simple distribution

### Output Structure

```markdown
# Design Documentation Export

**Module:** effect-type-registry
**Exported:** 2026-01-17 15:30:00 UTC
**Format:** Markdown
**Documents:** 3

---

## Table of Contents

1. [Observability System](#observability-system)
2. [Cache Optimization](#cache-optimization)
3. [Architecture](#architecture)

---

## Observability System

[... content ...]

---

## Cache Optimization

[... content ...]
```

### Markdown Processing Steps

#### 1. Read Document Content

Load full markdown content including frontmatter.

#### 2. Clean Frontmatter

**Options:**

- **Preserve:** Convert to code block at top of doc
- **Remove:** Strip frontmatter completely
- **Convert:** Extract to metadata header

**Preserved example:**

```markdown
```yaml
---
status: current
completeness: 85
category: observability
---
` ``
```

#### 3. Fix Relative Links

Convert relative links to absolute or remove:

```markdown
<!-- Before -->
See [cache optimization](./cache-optimization.md)

<!-- After - absolute -->
See [cache optimization](.claude/design/effect-type-registry/cache-optimization.md)

<!-- After - removed -->
See cache optimization documentation
```

#### 4. Process Code Blocks

Preserve code blocks with language tags:

```markdown
```typescript
export class TypeRegistry {
  // ...
}
` ``
```

#### 5. Generate Table of Contents

Extract headings and create TOC:

```markdown
## Table of Contents

- [Overview](#overview)
- [Current State](#current-state)
  - [Implementation](#implementation)
  - [Performance](#performance)
- [Rationale](#rationale)
```

### Markdown Features

**Includes:**

- Full markdown content
- Metadata header
- Combined TOC (if multiple docs)
- Preserved code blocks
- Fixed links
- Document separators

**Output location:**

```text
.claude/exports/
  effect-type-registry-design-docs.md
```

### Markdown Validation

- Valid markdown syntax
- All links resolved
- No broken references
- No stray frontmatter

## Format 2: HTML

### HTML Best Use Cases

- Web viewing in browsers
- Sharing via email or web links
- Interactive presentations
- Responsive documentation

### HTML Requirements

Check for markdown to HTML converter:

```bash
# Check for pandoc (recommended)
which pandoc

# Alternative: markdown-it, marked, etc.
# npm install -g markdown-it
```

### HTML Template Structure

```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>{module} - Design Documentation</title>
    <style>
        /* CSS styling based on theme */
    </style>
</head>
<body>
    <header>
        <h1>{module} - Design Documentation</h1>
        <p>Exported: {date}</p>
    </header>

    <nav id="toc">
        <!-- Table of contents -->
    </nav>

    <main>
        <!-- Document content -->
    </main>

    <footer>
        <p>Generated by design-export skill</p>
    </footer>
</body>
</html>
```

### HTML Processing Steps

#### 1. Convert Markdown to HTML

Using pandoc:

```bash
pandoc input.md -o output.html --standalone \
  --css=style.css \
  --highlight-style=pygments \
  --toc --toc-depth=3
```

#### 2. Apply CSS Styling

Embed CSS based on selected theme (see Style Themes section).

#### 3. Add Syntax Highlighting

Use Pygments or highlight.js for code blocks:

```html
<pre><code class="language-typescript">
export class TypeRegistry {
  // ...
}
</code></pre>
```

#### 4. Generate Navigation

Create interactive table of contents:

```html
<nav id="toc">
    <h2>Table of Contents</h2>
    <ul>
        <li><a href="#overview">Overview</a></li>
        <li><a href="#current-state">Current State</a>
            <ul>
                <li><a href="#implementation">Implementation</a></li>
            </ul>
        </li>
    </ul>
</nav>
```

#### 5. Handle Images

**Embed option:**

```html
<img src="data:image/png;base64,..." alt="Diagram">
```

**Link option:**

```html
<img src="./diagrams/architecture.png" alt="Diagram">
```

### Style Themes

#### Default Theme

**Characteristics:**

- Clean, professional styling
- Good contrast for readability
- Syntax highlighting enabled
- Responsive design

**CSS highlights:**

```css
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6;
    max-width: 900px;
    margin: 0 auto;
    padding: 2rem;
}

code {
    background: #f4f4f4;
    padding: 0.2em 0.4em;
    border-radius: 3px;
}

pre code {
    display: block;
    padding: 1em;
    overflow-x: auto;
}
```

#### GitHub Theme

**Characteristics:**

- GitHub markdown style
- Familiar look for developers
- Code-focused design
- Monospace fonts

**Use when:**

- Target audience: developers
- Code-heavy documentation
- GitHub integration

#### Minimal Theme

**Characteristics:**

- Minimal styling
- Printer-friendly
- Black and white
- High contrast

**Use when:**

- Printing documentation
- Accessibility focus
- Simple distribution

**CSS highlights:**

```css
body {
    font-family: serif;
    max-width: 800px;
    margin: 0 auto;
    color: #000;
    background: #fff;
}

@media print {
    nav { display: none; }
}
```

### HTML Features

**Includes:**

- Styled HTML5
- Syntax highlighting
- Interactive TOC with links
- Responsive design
- Embedded CSS
- Optional embedded images

**Output location:**

```text
.claude/exports/
  effect-type-registry-design-docs.html
```

### HTML Validation

Validate HTML if tidy is installed:

```bash
tidy -q -e output.html 2>&1 | head -20
```

**Check for:**

- Valid HTML5 structure
- CSS loads correctly
- Images embedded/linked properly
- No broken links
- Proper encoding (UTF-8)

## Format 3: PDF

### PDF Best Use Cases

- Printing documentation
- Formal distribution to stakeholders
- Long-term archival
- Professional presentations

### PDF Requirements

Check for PDF generator:

```bash
# Check for pandoc (recommended)
which pandoc

# Check for LaTeX (required for pandoc PDF)
which xelatex

# Alternative: wkhtmltopdf
which wkhtmltopdf
```

### Processing via Pandoc

#### Basic PDF Generation

```bash
pandoc input.md -o output.pdf \
  --pdf-engine=xelatex \
  --toc --toc-depth=3 \
  --highlight-style=pygments \
  --variable=geometry:margin=1in \
  --variable=fontsize:11pt \
  --variable=documentclass:article
```

#### PDF Metadata

Include metadata in PDF:

```bash
pandoc input.md -o output.pdf \
  --pdf-engine=xelatex \
  --metadata title="effect-type-registry Design Documentation" \
  --metadata author="Generated by design-export" \
  --metadata subject="Design documentation" \
  --metadata keywords="effect-type-registry,design,architecture"
```

### PDF Options

#### Page Configuration

- **Page size:** Letter (default) or A4
- **Orientation:** Portrait (default) or landscape
- **Margins:** 1 inch (default)

```bash
# A4 with custom margins
--variable=geometry:"a4paper,margin=2cm"

# Landscape orientation
--variable=geometry:"landscape"
```

#### Typography

- **Font size:** 11pt (default), 10pt, 12pt
- **Font family:** Default, serif, sans-serif
- **Line spacing:** 1.0, 1.5, 2.0

```bash
# 12pt font with line spacing
--variable=fontsize:12pt \
--variable=linestretch:1.5
```

#### Document Structure

- **Document class:** article (default), report, book
- **Table of contents:** Enabled with depth control
- **Page numbers:** Enabled by default
- **Syntax highlighting:** Pygments style

```bash
# Report class with detailed TOC
--variable=documentclass:report \
--toc --toc-depth=4
```

### PDF Metadata Fields

**Standard fields:**

- **Title:** `{module} - Design Documentation`
- **Author:** `Generated by design-export`
- **Subject:** `Design documentation`
- **Keywords:** `{module}, design, architecture`
- **Creator:** `pandoc + design-export`
- **Producer:** `XeLaTeX`

### PDF Features

**Includes:**

- Formatted document with professional layout
- Page numbers
- Table of contents with page references
- Syntax highlighting
- Proper typography
- PDF metadata
- Bookmarks for navigation

**Output location:**

```text
.claude/exports/
  effect-type-registry-design-docs.pdf
```

### PDF Validation

Check PDF validity if pdfinfo is installed:

```bash
# Get PDF information
pdfinfo output.pdf

# Output example:
# Title:          effect-type-registry - Design Documentation
# Author:         Generated by design-export
# Creator:        LaTeX with hyperref
# Producer:       xdvipdfmx (20200315)
# CreationDate:   Fri Jan 17 15:30:00 2026
# Tagged:         no
# UserProperties: no
# Suspects:       no
# Form:           none
# JavaScript:     no
# Pages:          47
# Encrypted:      no
# Page size:      612 x 792 pts (letter)
# Page rot:       0
# File size:      2456789 bytes
# Optimized:      no
# PDF version:    1.5
```

**Validation checks:**

- ✅ PDF file is valid
- ✅ Contains expected page count
- ✅ Metadata included
- ✅ TOC present
- ✅ File size reasonable

### Alternative: wkhtmltopdf

If pandoc + LaTeX is not available:

```bash
# Convert HTML to PDF
wkhtmltopdf --enable-local-file-access \
  --outline --outline-depth 3 \
  input.html output.pdf
```

**Process:**

1. Generate HTML first (see HTML format)
2. Convert HTML to PDF using wkhtmltopdf
3. Simpler than LaTeX but less control

## Format Comparison

| Feature | Markdown | HTML | PDF |
| :------ | :------- | :--- | :-- |
| Syntax highlighting | ✓ | ✓ | ✓ |
| Table of contents | ✓ | ✓ | ✓ |
| Styling | - | ✓ | ✓ |
| Interactive links | - | ✓ | - |
| Print-ready | - | - | ✓ |
| Version control friendly | ✓ | - | - |
| File size | Small | Medium | Large |
| External tools required | - | pandoc | pandoc + LaTeX |
| Browser viewable | - | ✓ | ✓ |

## Format Selection Guide

### Choose Markdown when

- Need plain text output
- Tracking in version control
- Further processing required
- Simplicity is priority

### Choose HTML when

- Web viewing required
- Interactive navigation needed
- Sharing via browser
- Responsive design wanted

### Choose PDF when

- Printing required
- Formal distribution needed
- Long-term archival
- Professional presentation

## Common Issues

### Issue 1: Missing Pandoc

**Error:**

```text
bash: pandoc: command not found
```

**Solution:**

```bash
# macOS
brew install pandoc

# Linux (Debian/Ubuntu)
apt-get install pandoc

# Or use markdown export instead
```

### Issue 2: LaTeX Compilation Failed

**Error:**

```text
Error running filter pandoc-xelatex:
Could not find xelatex
```

**Solution:**

```bash
# macOS
brew install --cask mactex-no-gui

# Linux
apt-get install texlive-xetex

# Or use wkhtmltopdf instead
brew install wkhtmltopdf
```

### Issue 3: PDF File Too Large

**Problem:** PDF > 50 MB

**Solutions:**

1. Export modules separately
2. Reduce image quality
3. Remove large diagrams
4. Use HTML instead

### Issue 4: Broken Links in HTML

**Problem:** Links don't work in exported HTML

**Solutions:**

1. Use absolute paths
2. Copy linked files to export directory
3. Convert links to text
4. Use base URL in HTML

### Issue 5: Syntax Highlighting Missing

**Problem:** Code blocks not highlighted

**Solutions:**

```bash
# Enable Pygments in pandoc
pandoc --highlight-style=pygments input.md -o output.html

# Or use different style
pandoc --highlight-style=github input.md -o output.html

# Available styles:
# pygments, tango, espresso, zenburn, kate, monochrome, breezedark, haddock
```

## Advanced Features

### Custom CSS for HTML

Provide custom CSS file:

```bash
pandoc input.md -o output.html --css=custom.css
```

**Custom CSS example:**

```css
/* custom.css */
:root {
    --primary-color: #0066cc;
    --bg-color: #ffffff;
    --text-color: #333333;
}

body {
    background: var(--bg-color);
    color: var(--text-color);
}

h1, h2, h3 {
    color: var(--primary-color);
}
```

### Custom LaTeX Template for PDF

Use custom LaTeX template:

```bash
pandoc input.md -o output.pdf \
  --template=custom-template.tex \
  --pdf-engine=xelatex
```

### Embedded Fonts in PDF

Include custom fonts:

```bash
pandoc input.md -o output.pdf \
  --pdf-engine=xelatex \
  --variable=mainfont:"Helvetica Neue" \
  --variable=monofont:"Fira Code"
```

### Multi-Column PDF Layout

Create two-column layout:

```bash
pandoc input.md -o output.pdf \
  --pdf-engine=xelatex \
  --variable=classoption:twocolumn
```
